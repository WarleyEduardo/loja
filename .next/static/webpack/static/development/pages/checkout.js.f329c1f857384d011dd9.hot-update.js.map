{"version":3,"file":"static/webpack/static\\development\\pages\\checkout.js.f329c1f857384d011dd9.hot-update.js","sources":["webpack:///./containers/Checkout/DadosPagamento.js"],"sourcesContent":["/* modulo 42 - pagina de Checkout - criando o componente de dados  de pagamento 1/2 */\r\nimport React, { Component } from 'react';\r\n\r\nimport FormRadio from '../../components/Inputs/FormRadio';\r\nimport FormSimples from '../../components/Inputs/FormSimples';\r\n\r\n/* módulo 49 -  Dados de pagamento - preparando a base, actions e  funções do pagseguro */\r\n\r\nimport { connect } from 'react-redux';\r\nimport actions from '../../redux/actions';\r\n\r\n/* modulo 49 -  Dados de pagamento integrando componentes e funcionalidades (1/2) */\r\n/* modulo 49 -  Dados de pagamento integrando componentes e funcionalidades (2/2) */\r\n/*modulo 49 - Dados de pagamento - finalizando componente*/\r\n\r\nimport { formatCPF, formatCartao, formatNumber } from '../../utils/format';\r\n\r\nimport { formatMoney } from '../../utils';\r\n\r\nimport { validateCPF } from '../../utils/validade';\r\n\r\nclass DadosPagamento extends Component {\r\n\t\r\n\t\r\n\tstate = {\r\n\t\topcaoPagamentoSelecionada: 'boleto',\r\n\t\tCPF: \"\",\r\n\t\tnumeroCartao: \"\",\r\n\t\tnomeCartao: \"\",\r\n\t\tCVVCartao: \"\",\r\n\t\tmesCartao: \"\",\r\n\t\tanoCartao: \"\"\r\n\t};\r\n\r\n\t\r\n\r\n\tcomponentDidMount() {\r\n\t\t\r\n\t\tthis.props.getSessionPagamento();\r\n\t}\r\n\r\n\r\n\tcomponentDidUpdate(prevProps) {\r\n\r\n\t\tconst {\r\n\r\n\t\t\tnumeroCartao,\r\n\t    \tCVVCartao,\r\n\t\t\tmesCartao,\r\n\t\t\tanoCartao,\r\n\t\t\tcredit_card_token,\r\n\t\t\tbandeira_cartao,\r\n\t\t\tparcelasCartao\r\n\r\n\t\t} = this.props.form;\r\n\t\t\r\n\t\tif (!bandeira_cartao && numeroCartao && numeroCartao.split(' ').join('').length > 7) {\r\n\t\t\t\r\n\t\t\t\r\n\t\t\tthis.getBrand();\r\n\t\t};\r\n\r\n\t\tif (!credit_card_token && numeroCartao && numeroCartao.split(' ').join('').length === 16\r\n\t\t\t&& mesCartao && mesCartao.length === 2 && anoCartao && anoCartao.length === 4\r\n\t\t\t&& CVVCartao && CVVCartao.length === 3 && bandeira_cartao)\r\n\t\t\tthis.submitCartaoHash();\r\n\r\n\r\n\t\tif ((!parcelasCartao && bandeira_cartao) ||\r\n\t\t\t(parcelasCartao && bandeira_cartao &&\r\n\t\t\tprevProps.freteSelecionado !== this.props.freteSelecionado)) this.getParcelas()\t\r\n\r\n\t}\r\n\r\n    \r\n\tgetBrand() {\r\n\t\t\r\n\t\tconst { numeroCartao } = this.props.form;\r\n\t\tPagSeguroDirectPayment.getBrand({\r\n\r\n\t\t\tcardBin: numeroCartao.split(' ').join('').slice(0, 6),\r\n\t\t\tsuccess: (r) => {\r\n\t\t\t\tthis.props.setForm({ bandeira_cartao: r.brand });\r\n\t\t\t},\r\n\t\t\terror: (r) => console.log(r),\r\n\t\t\t\r\n\t\t});\r\n\t}\r\n\r\n\r\n\r\n\tsubmitCartaoHash() {\r\n\t\tconst {\r\n\r\n\t\t\tnumeroCartao,\r\n\t\t\tmesCartao,\r\n\t\t\tanoCartao,\r\n\t\t\tCVVCartao,\r\n\t\t\tbandeira_cartao } = this.props.form;\r\n\t\t\r\n\t\tconst params = {\r\n\t\t\tcardNumber: numeroCartao.split(' ').join(''),\r\n\t\t\tbrand: bandeira_cartao.name,\r\n\t\t\tcvv: CVVCartao,\r\n\t\t\texpirationMonth: mesCartao,\r\n\t\t\texpirationYear: anoCartao,\r\n\t\t\tsuccess: (r) => {\r\n\t\t\t\tconsole.log('submitCartaoHash: ', r);\r\n\t\t\t\tthis.props.setForm({ credit_card_token: r.card.token });\r\n\t\t\t},\r\n\t\t\terror: (r) => console.log('submitCartaoHash', r),\r\n\t\t};\r\n\r\n\t\tPagSeguroDirectPayment.createCardToken(params);\r\n\t}\r\n\r\n\tgetParcelas() { \r\n\r\n\t\tconst { freteSelecionado, carrinho } = this.props;\r\n\r\n\t\tconst { bandeira_cartao } = this.props.form;\r\n\r\n\t\r\n\t\tlet valorItem = carrinho.reduce((all, item) => \r\n\t\t\tall + (Number(item.precoUnitario) * Number(item.quantidade))\r\n\t\t, 0);\r\n\r\n\t\tlet valorFrete = Number(freteSelecionado.Valor.replace(',', '.'));\r\n\r\n\t\tlet valorTotal = valorItem + valorFrete;\r\n\t\tvalorTotal = valorTotal.toFixed(2);\r\n\r\n\t\t\t        \r\n\t\tPagSeguroDirectPayment.getInstallments({\r\n\t\t\tamount: valorTotal,\r\n\t\t\tmaxInstallmentNoInterest: 6,\r\n\t\t\tmaxInstallment: 6,\r\n\t\t\tbrand: bandeira_cartao.name,\r\n\t\t\tsuccess: (data) => {\r\n\t\t\t\tthis.props.setForm({ parcelasCartao: data.installments });\r\n\t\t\t\tthis.props.setForm({ parcelasCartaoSelecionada: data.installments[bandeira_cartao.name][0] });\r\n\t\t\t},\r\n\t\t\terror: (e) => console.log('getParcelas', e),\r\n\t\t});\r\n\t}\r\n\t\r\n\r\n\trenderOpcoesPagamento() {\r\n\t\tconst { tipoPagamentoSelecionado } = this.props;\r\n\r\n\t\treturn (\r\n\t\t\t<div className='flex horizontal'>\r\n\t\t\t\t<div className='flex-1'>\r\n\t\t\t\t\t<FormRadio\r\n\t\t\t\t\t\tname='tipo_pagamento_selecionado'\r\n\t\t\t\t\t\tchecked={tipoPagamentoSelecionado === 'boleto'}\r\n\t\t\t\t\t\tonChange={() => this.props.setTipoPagamento('boleto')}\r\n\t\t\t\t\t\tlabel='Boleto Bancário'\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className='flex-1'>\r\n\t\t\t\t\t<FormRadio\r\n\t\t\t\t\t\tname='tipo_pagamento_selecionado'\r\n\t\t\t\t\t\tchecked={tipoPagamentoSelecionado === 'cartao'}\r\n\t\t\t\t\t\tonChange={() => this.props.setTipoPagamento('cartao')}\r\n\t\t\t\t\t\tlabel='Cartão de Crédito'\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\tvalidate() {\r\n\r\n\t\tconst { tipoPagamentoSelecionado } = this.props;\r\n\t\tconst {\r\n\t\t\tcpf, cpfBoleto, numeroCartao, nomeCartao, mesCartao , anoCartao, parcelasCartaoSelecionada,\r\n\t\t\tCVVCartao } = this.props.form;\r\n\t\t\r\n\t\tconst erros = {};\r\n\r\n\r\n\t\tif (tipoPagamentoSelecionado === 'boleto') {\r\n\r\n\t\t\tif (!cpfBoleto && !cpf) erros.cpfBoleto = \"Preencha aqui com o seu cpf\";\r\n\t\t\tif (!cpfBoleto && cpfBoleto.length !== 14 && !validateCPF(cpfBoleto))\r\n\t\t\t\terros.cpfBoleto = \"Preencha aqui com o seu cpf corretamente\";\r\n\t\t} else {\r\n\r\n\t\t\tif (!numeroCartao || numeroCartao.length !== 19) erros.numeroCartao = \"Preencha aqui com o número do seu cartão\";\r\n\r\n\t\t\tif (!nomeCartao) erros.nomeCartao = 'Preencha aqui com o nome que está no cartão';\r\n\t\t\tif (!mesCartao) erros.mesCartao = 'Preencha aqui com o mês de vencimento  do cartão';\r\n\t\t\tif (!anoCartao) erros.anoCartao = 'Preencha aqui com o ano de vencimento  do cartão';\r\n\t\t\tif (!CVVCartao && CVVCartao.length !== 3) erros.CVVCartao = 'Preencha aqui o código de validação do cartão';\r\n\t\t\tif (!parcelasCartaoSelecionada) erros.parcelasCartaoSelecionada = \"selecione uma condição de pagamento\"\r\n\r\n\r\n\t\t}\r\n\t\t\r\n\r\n\t}\r\n\r\n\tonChange = (field, value) => this.props.setForm({ [field]: value }).then(()=> this.validate());\r\n\r\n\trenderPagamentoComBoleto() {\r\n\t\t\r\n\t\tconst { cpf, cpfBoleto } = this.props.form;\r\n\t\treturn (\r\n\t\t\t<div className='Dados-Pagamento'>\r\n\t\t\t\t<FormSimples value={cpfBoleto || cpf}\r\n\t\t\t\t\tnome='CPF'\r\n\t\t\t\t\tplaceholder='CPF'\r\n\t\t\t\t\tlabel='CPF'\r\n\t\t\t\t\tonChange={(e) => this.onChange(\"cpfBoleto\" ,formatCPF(e.target.value))} />\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\r\n\trenderPagamentoComCartao() {\r\n\t\tconst { nomeCartao, numeroCartao,\r\n\t\t\tCVVCartao, mesCartao, anoCartao,\r\n\t\t\tparcelasCartao, parcelasCartaoSelecionada,\r\n\t\t\tbandeira_cartao\r\n\t\t} = this.props.form;\r\n\r\n\r\n\t\tconst ValorPrestacao = parcelasCartao ? parcelasCartao[bandeira_cartao.name][0].installmentAmount : 0;\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<div className='Dados-Pagamento'>\r\n\t\t\t\t<FormSimples\r\n\t\t\t\t\tvalue={nomeCartao}\r\n\t\t\t\t\tnome='nomeCartao'\r\n\t\t\t\t\tplaceholder='Nome como escrito no cartão'\r\n\t\t\t\t\tlabel='Nome completo no cartão'\r\n\t\t\t\t\tonChange={(e) => this.onChange('nomeCartao', e.target.value)}\r\n\t\t\t\t/>\r\n\t\t\t\t<div className='flex horizontal'>\r\n\t\t\t\t\t<div className='flex-1'>\r\n\t\t\t\t\t\t<FormSimples\r\n\t\t\t\t\t\t\tvalue={numeroCartao}\r\n\t\t\t\t\t\t\tnome='numeroCartao'\r\n\t\t\t\t\t\t\tplaceholder='xxxx xxxx xxxx xxxx'\r\n\t\t\t\t\t\t\tlabel='Número do cartão'\r\n\t\t\t\t\t\t\tonChange={(e) => this.onChange('numeroCartao', formatCartao(e.target.value))}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className='flex-1'>\r\n\t\t\t\t\t\t<FormSimples\r\n\t\t\t\t\t\t\tvalue={CVVCartao}\r\n\t\t\t\t\t\t\tnome='CVVCartao'\r\n\t\t\t\t\t\t\tplaceholder='xxxx'\r\n\t\t\t\t\t\t\tlabel='Código de Segurança do Cartão'\r\n\t\t\t\t\t\t\tonChange={(e) => this.onChange('CVVCartao', formatNumber(e.target.value, 3))}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className='form-input'>\r\n\t\t\t\t\t<label>Data de Validade</label>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className='flex'>\r\n\t\t\t\t\t<FormSimples value={mesCartao} nome='mesCartao' placeholder='MM' label='Mês' onChange={(e) => this.onChange('mesCartao', formatNumber(e.target.value, 2))} />\r\n\t\t\t\t\t<span className='slash-pagamento'>&nbsp;/&nbsp;</span>\r\n\t\t\t\t\t<FormSimples value={anoCartao} nome='anoCartao' placeholder='AAAA' label='Ano' onChange={(e) => this.onChange('anoCartao', formatNumber(e.target.value, 4))} />\r\n\t\t\t\t</div>\r\n\t\t\t\t<br />\r\n\t\t\t\t<div className='form-input'>\r\n\t\t\t\t\t<label>Parcelas</label>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{parcelasCartao && parcelasCartaoSelecionada && (\r\n\t\t\t\t\t<div className='flex'>\r\n\t\t\t\t\t\t<select\r\n\t\t\t\t\t\t\tname='parcela'\r\n\t\t\t\t\t\t\tvalue={parcelasCartaoSelecionada.quantity}\r\n\t\t\t\t\t\t\tonChange={(e) => this.onChange('parcelasCartaoSelecionada',\r\n\t\t\t\t\t\t\t\tparcelasCartao[bandeira_cartao.name][e.target.value - 1])}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<option>Selecione a quantidade de parcelas para pagamento</option>\r\n\r\n\t\t\t\t\t\t\t{parcelasCartao[bandeira_cartao.name].slice(0,6).map((item, index) => (\r\n\t\t\t\t\t\t\t\t<option option key={index} value={item.quantity}>\r\n\t\t\t\t\t\t\t\t\t{item.quantity} x de {formatMoney(item.installmentAmount)}\r\n\t\t\t\t\t\t\t\t\t{ValorPrestacao === item.totalAmount ? '  sem juros ' : ''}\r\n\t\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\r\n\trender() {\r\n\t\tconst { tipoPagamentoSelecionado } = this.props;\r\n\t\treturn (\r\n\t\t\t<div className='Dados-Pagamento-Container'>\r\n\t\t\t\t<h2>DADOS DE PAGAMENTO</h2>\r\n\t\t\t\t<br />\r\n\t\t\t\t{this.renderOpcoesPagamento()}\r\n\t\t\t\t<br />\r\n\t\t\t\t<br />\r\n\t\t\t\t{tipoPagamentoSelecionado === 'boleto' && this.renderPagamentoComBoleto()}\r\n\t\t\t\t{tipoPagamentoSelecionado === 'cartao' && this.renderPagamentoComCartao()}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\n\r\nconst mapStateToProps = state => ({\r\n\r\n\tusuario: state.auth.usuario,\r\n\tcarrinho: state.carrinho.carrinho,\r\n\tcliente: state.cliente.cliente,\r\n\tform: state.checkout.form,\r\n\ttipoPagamentoSelecionado: state.checkout.tipoPagamentoSelecionado,\r\n\tsessionId: state.checkout.senderId,\r\n\tsenderHash: state.checkout.senderHash,\r\n\tfreteSelecionado: state.carrinho.freteSelecionado\r\n})\r\n\r\nexport default connect(mapStateToProps,actions)(DadosPagamento);"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AA2KA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AArKA;AACA;AAAA;AAAA;AAAA;AAKA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;AAGA;AACA;AAAA;AAEA;AAMA;AAIA;AAAA;AAAA;AAAA;AAGA;AAEA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AAIA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AAEA;AAEA;AAAA;AAAA;AAEA;AAGA;AAAA;AACA;AAGA;AAEA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAGA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAIA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AAGA;AAEA;AACA;AAEA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAGA;AAGA;AAAA;AAAA;AAAA;AAIA;AAEA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAGA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AAIA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAOA;AAAA;AAAA;AAAA;AAIA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAIA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAEA;;;;A","sourceRoot":""}
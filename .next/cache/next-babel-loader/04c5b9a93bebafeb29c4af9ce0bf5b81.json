{"ast":null,"code":"/* modulo 40 - loja virtual - criando helper para inicialização*/\n\n/* modulo 44 - Criando actions e reduces para integração 1/2*/\n\nimport { AUTENTICAR_TOKEN, USER, AUTENTICAR, DESAUTENTICAR } from '../types';\nimport axios from 'axios';\nimport { url } from '../../config.js';\n\n/* modulo 47 - integrando o componente de avaliações 2/2 */\n//const getHeaders = token => ({ headers: { \"Authorization\": `Ecommerce ${token}` } });\nimport { getHeaders } from './helpers';\n\n/* modulo 49  - Criando as funções e error handlign para os dados do cliente 1/2*/\n/* modulo 49  - Criando as funções e error handlign para os dados do cliente 2/2*/\n\nimport { setCookie, removeCookie } from '../../utils/cookie';\nimport Router from 'next/router';\nimport errorHandling from './errorHandling';\n\n/*Módulo 51 -  menu -  criando actionse reducers ...*/\n\nexport var desautenticar = function desautenticar() {\n  return function (dispatch) {\n    removeCookie('token');\n    Router.push('/');\n    dispatch({\n      type: DESAUTENTICAR\n    });\n  };\n};\nexport var updateSenha = function updateSenha(data, token, cb) {\n  return function (dispatch) {\n    axios.put(\"\".concat(url, \"/api/usuarios\"), {\n      password: data.novaSenha\n    }, getHeaders(token)).then(function (response) {\n      dispatch({\n        type: USER,\n        payload: response.data.usuario\n      });\n      cb(null);\n    })[\"catch\"](function (e) {\n      return cb(errorHandling(e));\n    });\n  };\n};\nexport var reauthenticate = function reauthenticate(token) {\n  return {\n    type: AUTENTICAR_TOKEN,\n    payload: token\n  };\n};\nexport var getUser = function getUser(_ref) {\n  var token = _ref.token;\n  return function (dispatch) {\n    axios.get(\"\".concat(url, \"/api/usuarios\"), getHeaders(token)).then(function (response) {\n      return dispatch({\n        type: USER,\n        payload: response.data.usuario\n      });\n    })[\"catch\"](function (e) {\n      return console.log(e);\n    });\n  };\n};\n\n/*Criando as funções e error handlign para os dados do cliente 1/2*/\n\nexport var autenticar = function autenticar(_ref2) {\n  var email = _ref2.email,\n    password = _ref2.password;\n  var goTo = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : fase;\n  var cb = arguments.length > 2 ? arguments[2] : undefined;\n  return function (dispatch) {\n    axios.post(\"\".concat(url, \"/api/usuarios/login\"), {\n      email: email,\n      password: password\n    }).then(function (response) {\n      setCookie('token', response.data.usuario.token);\n      if (goTo) Router.push(goTo);\n      dispatch({\n        type: AUTENTICAR,\n        payload: response.data\n      });\n      dispatch(fetchCliente(response.data.usuario._id, response.data.usuario.token));\n    })[\"catch\"](function (e) {\n      return cb(errorHandling(e));\n    });\n  };\n};\nexport default {\n  reauthenticate: reauthenticate,\n  getUser: getUser,\n  autenticar: autenticar,\n  desautenticar: desautenticar,\n  updateSenha: updateSenha\n};","map":{"version":3,"names":["AUTENTICAR_TOKEN","USER","AUTENTICAR","DESAUTENTICAR","axios","url","getHeaders","setCookie","removeCookie","Router","errorHandling","desautenticar","dispatch","push","type","updateSenha","data","token","cb","put","password","novaSenha","then","response","payload","usuario","e","reauthenticate","getUser","get","console","log","autenticar","email","goTo","fase","post","fetchCliente","_id"],"sources":["D:/javaScript/lojavirtual/lojavirtual/redux/actions/authActions.js"],"sourcesContent":["/* modulo 40 - loja virtual - criando helper para inicialização*/\r\n\r\n/* modulo 44 - Criando actions e reduces para integração 1/2*/\r\n\r\nimport { AUTENTICAR_TOKEN, USER, AUTENTICAR, DESAUTENTICAR } from '../types';\r\n\r\nimport axios from 'axios';\r\nimport { url } from '../../config.js';\r\n\r\n\r\n/* modulo 47 - integrando o componente de avaliações 2/2 */\r\n//const getHeaders = token => ({ headers: { \"Authorization\": `Ecommerce ${token}` } });\r\nimport { getHeaders } from './helpers';\r\n\r\n\r\n/* modulo 49  - Criando as funções e error handlign para os dados do cliente 1/2*/\r\n/* modulo 49  - Criando as funções e error handlign para os dados do cliente 2/2*/\r\n\r\nimport { setCookie ,removeCookie } from '../../utils/cookie';\r\nimport Router from 'next/router';\r\nimport errorHandling from './errorHandling';\r\n\r\n/*Módulo 51 -  menu -  criando actionse reducers ...*/\r\n\r\nexport const desautenticar = () => dispatch => {\r\n\r\n\tremoveCookie('token');\r\n\tRouter.push('/');\r\n\tdispatch({type : DESAUTENTICAR})\r\n}\r\n\r\nexport const updateSenha = (data, token, cb) => dispatch => {\r\n\t\r\n\taxios.put(`${url}/api/usuarios`, { password: data.novaSenha }, getHeaders(token))\r\n\t\t.then(response => {\r\n\t\t\r\n\t\t\tdispatch({ type: USER, payload: response.data.usuario })\r\n\t\t\tcb(null)\r\n\t\t})\r\n\t     .catch(e => cb(errorHandling(e)))\r\n}\r\n\t\r\n\r\nexport const reauthenticate = token => ({ type: AUTENTICAR_TOKEN, payload: token})\r\n\r\nexport const getUser = ({ token }) => (dispatch) => {\r\n\t\r\n\t\r\n\taxios.get(`${url}/api/usuarios`, getHeaders(token))\r\n\t\t.then((response) => dispatch({ type: USER, payload: response.data.usuario }))\r\n\t    .catch( e => console.log(e))\r\n}\r\n\r\n/*Criando as funções e error handlign para os dados do cliente 1/2*/\r\n\r\nexport const autenticar = ({ email, password } , goTo = fase , cb) => (dispatch) => {\r\n\t\taxios.post(`${url}/api/usuarios/login`, { email, password})\r\n\t\t\t.then((response) => {\r\n\t\t\t\t\r\n\t\t\t\tsetCookie('token', response.data.usuario.token);\r\n\t\t\r\n\t\t\t\tif (goTo) Router.push(goTo) \r\n\t\r\n\r\n\t\t\t\tdispatch({ type: AUTENTICAR, payload: response.data });\r\n                dispatch(fetchCliente(response.data.usuario._id,response.data.usuario.token))  \r\n\r\n\t\t\t}\r\n\t\t).catch(\r\n\t\t\t(e) => cb(errorHandling(e))\t\t\t\r\n\t\t);\r\n\t};\r\n\r\nexport default {\r\n\treauthenticate,\r\n\tgetUser,\r\n\tautenticar,\r\n\tdesautenticar,\r\n\tupdateSenha\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}